<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Day - 1 Introduction to R and RStudio | r4proteomics</title>
<meta name="author" content="Miguel CASANOVA, PhD &amp; Dany MUKESHA">
<meta name="description" content="1.1 Learning Objectives By the end of Day 1, you will be able to: Install and navigate RStudio effectively Understand basic R data structures (vectors, data frames, lists) Import and explore...">
<meta name="generator" content="bookdown 0.45 with bs4_book()">
<meta property="og:title" content="Day - 1 Introduction to R and RStudio | r4proteomics">
<meta property="og:type" content="book">
<meta property="og:url" content="https://github.com/lodiag-holocron/r4proteomics/day1.html">
<meta property="og:image" content="https://github.com/lodiag-holocron/r4proteomics/r4proteomics.png">
<meta property="og:description" content="1.1 Learning Objectives By the end of Day 1, you will be able to: Install and navigate RStudio effectively Understand basic R data structures (vectors, data frames, lists) Import and explore...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Day - 1 Introduction to R and RStudio | r4proteomics">
<meta name="twitter:description" content="1.1 Learning Objectives By the end of Day 1, you will be able to: Install and navigate RStudio effectively Understand basic R data structures (vectors, data frames, lists) Import and explore...">
<meta name="twitter:image" content="https://github.com/lodiag-holocron/r4proteomics/r4proteomics.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="5-Day Training Course">r4proteomics</a>:
        <small class="text-muted">5-Day Training Course</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome </a></li>
<li><a class="active" href="day1.html"><span class="header-section-number">1</span> Introduction to R and RStudio</a></li>
<li><a class="" href="day2.html"><span class="header-section-number">2</span> Introduction to Proteomic Data &amp; Quality Control</a></li>
<li><a class="" href="day3.html"><span class="header-section-number">3</span> Preprocessing and Differential Expression</a></li>
<li><a class="" href="day4.html"><span class="header-section-number">4</span> Functional Analysis, Longitudinal &amp; Public Data</a></li>
<li><a class="" href="day5.html"><span class="header-section-number">5</span> Application on Real Data</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/lodiag-holocron/r4proteomics">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="day1" class="section level1" number="1">
<h1>
<span class="header-section-number">Day - 1</span> Introduction to R and RStudio<a class="anchor" aria-label="anchor" href="#day1"><i class="fas fa-link"></i></a>
</h1>
<div id="learning-objectives" class="section level2" number="1.1">
<h2>
<span class="header-section-number">1.1</span> Learning Objectives<a class="anchor" aria-label="anchor" href="#learning-objectives"><i class="fas fa-link"></i></a>
</h2>
<p>By the end of Day 1, you will be able to:</p>
<ul>
<li>Install and navigate RStudio effectively</li>
<li>Understand basic R data structures (vectors, data frames, lists)</li>
<li>Import and explore simple datasets</li>
<li>Write basic control flow structures and functions</li>
</ul>
</div>
<div id="day1-mod1" class="section level2" number="1.2">
<h2>
<span class="header-section-number">1.2</span> Module 1: Setting Up and Getting Started with R<a class="anchor" aria-label="anchor" href="#day1-mod1"><i class="fas fa-link"></i></a>
</h2>
<div id="introduction" class="section level3" number="1.2.1">
<h3>
<span class="header-section-number">1.2.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"><i class="fas fa-link"></i></a>
</h3>
<p>R is a powerful programming language and environment specifically designed for statistical computing and graphics. RStudio is an integrated development environment (IDE) that makes working with R much easier.</p>
</div>
<div id="installing-r-and-rstudio" class="section level3" number="1.2.2">
<h3>
<span class="header-section-number">1.2.2</span> Installing R and RStudio<a class="anchor" aria-label="anchor" href="#installing-r-and-rstudio"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<p><strong>Install R</strong> (version 4.3.0 or higher)</p>
<ul>
<li>Visit <a href="https://cran.r-project.org/" class="uri">https://cran.r-project.org/</a>
</li>
<li>Download the version appropriate for your operating system</li>
<li>Run the installer</li>
</ul>
</li>
<li>
<p><strong>Install RStudio Desktop</strong></p>
<ul>
<li>Visit <a href="https://posit.co/download/rstudio-desktop/" class="uri">https://posit.co/download/rstudio-desktop/</a>
</li>
<li>Download the free Desktop version</li>
<li>Run the installer</li>
</ul>
</li>
</ol>
</div>
<div id="rstudio-interface-tour" class="section level3" number="1.2.3">
<h3>
<span class="header-section-number">1.2.3</span> RStudio Interface Tour<a class="anchor" aria-label="anchor" href="#rstudio-interface-tour"><i class="fas fa-link"></i></a>
</h3>
<p>RStudio has four main panes:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Source Editor</strong> (top-left): Where you write and edit your scripts</li>
<li>
<strong>Console</strong> (bottom-left): Where code is executed and results appear</li>
<li>
<strong>Environment/History</strong> (top-right): Shows objects in memory and command history</li>
<li>
<strong>Files/Plots/Packages/Help</strong> (bottom-right): File browser, plot viewer, package manager, and help documentation</li>
</ol>
</div>
<div id="scripts-vs-console" class="section level3" number="1.2.4">
<h3>
<span class="header-section-number">1.2.4</span> Scripts vs Console<a class="anchor" aria-label="anchor" href="#scripts-vs-console"><i class="fas fa-link"></i></a>
</h3>
<p>The <strong>Console</strong> is for:</p>
<ul>
<li>Quick calculations</li>
<li>Testing commands</li>
<li>Interactive exploration</li>
</ul>
<p><strong>Scripts</strong> (.R or .Rmd files) are for: - Saving your work - Creating reproducible analyses - Organizing complex workflows</p>
</div>
<div id="install-required-r-packages" class="section level3" number="1.2.5">
<h3>
<span class="header-section-number">1.2.5</span> Install Required R Packages<a class="anchor" aria-label="anchor" href="#install-required-r-packages"><i class="fas fa-link"></i></a>
</h3>
<p>Open an R session in the terminal or RStudio:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install CRAN packages</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"bookdown"</span>, <span class="st">"rmarkdown"</span>, <span class="st">"knitr"</span>, <span class="st">"pheatmap"</span>, <span class="st">"ggplot2"</span>, <span class="st">"downlit"</span>, <span class="st">"xml2"</span>,</span>
<span>  <span class="st">"reshape2"</span>, <span class="st">"gridExtra"</span>, <span class="st">"tidyverse"</span>, <span class="st">"lme4"</span>,</span>
<span>  <span class="st">"ggforce"</span>, <span class="st">"scatterpie"</span>, <span class="st">"png"</span>  <span class="co"># Optional</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install Bioconductor packages</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html">install</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"limma"</span>, <span class="st">"vsn"</span>, <span class="st">"sva"</span>, <span class="st">"clusterProfiler"</span>, <span class="st">"org.Hs.eg.db"</span>, <span class="st">"lme4"</span>,</span>
<span>  <span class="st">"KEGGREST"</span>, <span class="st">"AnnotationDbi"</span>, <span class="st">"annotate"</span>, <span class="st">"GO.db"</span>,</span>
<span>  <span class="st">"genefilter"</span>, <span class="st">"GOSemSim"</span>, <span class="st">"DOSE"</span>, <span class="st">"enrichplot"</span></span>
<span><span class="op">)</span>, update <span class="op">=</span> <span class="cn">TRUE</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="basic-operators" class="section level3" number="1.2.6">
<h3>
<span class="header-section-number">1.2.6</span> Basic Operators<a class="anchor" aria-label="anchor" href="#basic-operators"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Please note:</strong></p>
<ul>
<li>R is case sensitive - be aware of capital letters (<strong>b is different from B</strong>).</li>
<li>All R code lines starting with the <strong>#</strong> (hash) sign are interpreted as comments, and therefore not evaluated.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Arithmetic operators</span></span>
<span><span class="fl">5</span> <span class="op">+</span> <span class="fl">3</span>        <span class="co"># Addition</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="fl">10</span> <span class="op">-</span> <span class="fl">4</span>       <span class="co"># Subtraction</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="fl">6</span> <span class="op">*</span> <span class="fl">7</span>        <span class="co"># Multiplication</span></span>
<span><span class="co">#&gt; [1] 42</span></span>
<span><span class="fl">20</span> <span class="op">/</span> <span class="fl">4</span>       <span class="co"># Division</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="fl">2</span> <span class="op">^</span> <span class="fl">3</span>        <span class="co"># Exponentiation</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="fl">17</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">5</span>      <span class="co"># Modulo (remainder)</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span></span>
<span><span class="co"># Comparison operators</span></span>
<span><span class="fl">5</span> <span class="op">==</span> <span class="fl">5</span>       <span class="co"># Equal to</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fl">5</span> <span class="op">!=</span> <span class="fl">3</span>       <span class="co"># Not equal to</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fl">7</span> <span class="op">&gt;</span> <span class="fl">3</span>        <span class="co"># Greater than</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fl">4</span> <span class="op">&lt;</span> <span class="fl">8</span>        <span class="co"># Less than</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fl">5</span> <span class="op">&gt;=</span> <span class="fl">5</span>       <span class="co"># Greater than or equal</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fl">3</span> <span class="op">&lt;=</span> <span class="fl">10</span>      <span class="co"># Less than or equal</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># Logical operators</span></span>
<span><span class="cn">TRUE</span> <span class="op">&amp;</span> <span class="cn">FALSE</span>  <span class="co"># AND</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="cn">TRUE</span> <span class="op">|</span> <span class="cn">FALSE</span>  <span class="co"># OR</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="op">!</span><span class="cn">TRUE</span>         <span class="co"># NOT</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span></span>
<span><span class="co"># Scientific notation</span></span>
<span><span class="fl">1.5e6</span>  <span class="co"># 1,500,000</span></span>
<span><span class="co">#&gt; [1] 1500000</span></span></code></pre></div>
</div>
<div id="variables-assignment" class="section level3" number="1.2.7">
<h3>
<span class="header-section-number">1.2.7</span> Variables &amp; Assignment<a class="anchor" aria-label="anchor" href="#variables-assignment"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Please note:</strong></p>
<ul>
<li>Spaces matter in variable names. Use a dot or underscore to create longer names to make the variables more descriptive, e.g. <code>my.variable_name</code>.</li>
<li>Spaces between variables and operators do not matter: <code>3+2</code> is the same as <code>3 + 2</code>, and <code>function (arg1 , arg2)</code> is the same as <code>function(arg1,arg2)</code>.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assignment operator</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">10</span>      <span class="co"># Assign 10 to x</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fl">5</span>        <span class="co"># Alternative (but &lt;- is preferred)</span></span>
<span><span class="co"># Tip: assignment operator has the following shortcuts:</span></span>
<span><span class="co"># Windows/Linux: Press Alt + - (the minus key).</span></span>
<span><span class="co"># Mac: Press Option + - (the minus key). </span></span>
<span></span>
<span><span class="co">## Assign values to variables</span></span>
<span><span class="va">protein_count</span> <span class="op">&lt;-</span> <span class="fl">800</span></span>
<span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">12</span></span>
<span><span class="va">study_name</span> <span class="op">&lt;-</span> <span class="st">"Proteomics_2025"</span></span>
<span></span>
<span><span class="co">## View variables</span></span>
<span><span class="va">protein_count</span></span>
<span><span class="co">#&gt; [1] 800</span></span>
<span><span class="va">sample_size</span></span>
<span><span class="co">#&gt; [1] 12</span></span>
<span></span>
<span><span class="co">## Use variables in calculations</span></span>
<span><span class="va">total_measurements</span> <span class="op">&lt;-</span> <span class="va">protein_count</span> <span class="op">*</span> <span class="va">sample_size</span></span>
<span><span class="va">total_measurements</span></span>
<span><span class="co">#&gt; [1] 9600</span></span></code></pre></div>
</div>
<div id="data-types" class="section level3" number="1.2.8">
<h3>
<span class="header-section-number">1.2.8</span> Data Types<a class="anchor" aria-label="anchor" href="#data-types"><i class="fas fa-link"></i></a>
</h3>
<p>The major data types are: Numeric (e.g. 1,2,3…); Character (e.g. “p”, “ro”, “teomics”) and Logical (TRUE or FALSE).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Numeric</span></span>
<span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="fl">25114306.44</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">intensity</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "numeric"</span></span>
<span></span>
<span><span class="co"># Character (text)</span></span>
<span><span class="va">accession</span> <span class="op">&lt;-</span> <span class="st">"F1LMU0"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">accession</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "character"</span></span>
<span></span>
<span><span class="co"># Logical</span></span>
<span><span class="va">is_significant</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">is_significant</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "logical"</span></span>
<span></span>
<span><span class="co"># Check type</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">intensity</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">accession</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div id="creating-your-first-script" class="section level3" number="1.2.9">
<h3>
<span class="header-section-number">1.2.9</span> Creating Your First Script<a class="anchor" aria-label="anchor" href="#creating-your-first-script"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a new R script: File &gt; New File &gt; R Script</span></span>
<span><span class="co"># Or use Ctrl+Shift+N (Windows/Linux) or Cmd+Shift+N (Mac)</span></span>
<span></span>
<span><span class="co"># Write your code</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Hello, Proteomics World!"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save your script: File &gt; Save</span></span>
<span><span class="co"># Run code: Ctrl+Enter (Windows/Linux) or Cmd+Return (Mac)</span></span></code></pre></div>
</div>
<div id="exercise-1.1-first-steps" class="section level3" number="1.2.10">
<h3>
<span class="header-section-number">1.2.10</span> Exercise 1.1: First Steps<a class="anchor" aria-label="anchor" href="#exercise-1.1-first-steps"><i class="fas fa-link"></i></a>
</h3>
<p>Create a new R script and:</p>
<ol style="list-style-type: decimal">
<li>Calculate the sum of 123 and 456</li>
<li>Assign the result to a variable called <code>total</code>
</li>
<li>Print the value of <code>total</code>
</li>
<li>Calculate what percentage 123 is of the total</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Solution</span></span>
<span><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fl">123</span> <span class="op">+</span> <span class="fl">456</span></span>
<span><span class="va">total</span> <span class="op">&lt;-</span> <span class="va">result1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 579</span></span>
<span></span>
<span><span class="va">percentage</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">123</span> <span class="op">/</span> <span class="va">total</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"123 is "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">percentage</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"% of the total"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "123 is 21.24% of the total"</span></span></code></pre></div>
</div>
</div>
<div id="day1-mod2" class="section level2" number="1.3">
<h2>
<span class="header-section-number">1.3</span> Module 2: Data Types and Structures<a class="anchor" aria-label="anchor" href="#day1-mod2"><i class="fas fa-link"></i></a>
</h2>
<div id="vectors" class="section level3" number="1.3.1">
<h3>
<span class="header-section-number">1.3.1</span> Vectors<a class="anchor" aria-label="anchor" href="#vectors"><i class="fas fa-link"></i></a>
</h3>
<p>Vectors are the most basic data structure in R. They contain elements of the same type.</p>
<p>If a vector contains multiple elements, you define them in R with a <code>c(elm1, elm2, elm3 ... elmN)</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Numeric vectors</span></span>
<span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">30</span>, <span class="fl">35</span>, <span class="fl">40</span>, <span class="fl">45</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ages</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 25 30 35 40 45</span></span>
<span></span>
<span><span class="co"># Character vectors</span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Charlie"</span>, <span class="st">"Diana"</span>, <span class="st">"Eve"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Alice"   "Bob"     "Charlie" "Diana"   "Eve"</span></span>
<span></span>
<span><span class="co"># Logical vectors</span></span>
<span><span class="va">passed_qc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">passed_qc</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE  TRUE FALSE  TRUE  TRUE</span></span>
<span></span>
<span><span class="co"># Sequences</span></span>
<span><span class="va">seq_1_10</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">seq_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">100</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Vector operations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ages</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 35</span></span></code></pre></div>
</div>
<div id="indexing-and-subsetting" class="section level3" number="1.3.2">
<h3>
<span class="header-section-number">1.3.2</span> Indexing and Subsetting<a class="anchor" aria-label="anchor" href="#indexing-and-subsetting"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Tip:</strong> In R vectors are 1-based, i.e. the first index position is number 1 (as opposed to other programming languages whose indexes start at zero).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Access elements by position (1-indexed!)</span></span>
<span><span class="va">ages</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>           <span class="co"># First element</span></span>
<span><span class="co">#&gt; [1] 25</span></span>
<span><span class="va">ages</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span>  <span class="co"># Multiple elements</span></span>
<span><span class="co">#&gt; [1] 25 35 45</span></span>
<span><span class="va">ages</span><span class="op">[</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span>          <span class="co"># All except second element</span></span>
<span><span class="co">#&gt; [1] 25 35 40 45</span></span>
<span></span>
<span><span class="co"># Logical indexing</span></span>
<span><span class="va">ages</span><span class="op">[</span><span class="va">ages</span> <span class="op">&gt;</span> <span class="fl">35</span><span class="op">]</span>   <span class="co"># Elements greater than 35</span></span>
<span><span class="co">#&gt; [1] 40 45</span></span>
<span></span>
<span><span class="co"># Named vectors</span></span>
<span><span class="va">protein_abundance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>ACTB <span class="op">=</span> <span class="fl">1500</span>, GAPDH <span class="op">=</span> <span class="fl">2000</span>, MYC <span class="op">=</span> <span class="fl">800</span><span class="op">)</span></span>
<span><span class="va">protein_abundance</span><span class="op">[</span><span class="st">"ACTB"</span><span class="op">]</span></span>
<span><span class="co">#&gt; ACTB </span></span>
<span><span class="co">#&gt; 1500</span></span></code></pre></div>
</div>
<div id="data-frames" class="section level3" number="1.3.3">
<h3>
<span class="header-section-number">1.3.3</span> Data Frames<a class="anchor" aria-label="anchor" href="#data-frames"><i class="fas fa-link"></i></a>
</h3>
<p>Data frames are the most common structure for storing tabular data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a data frame</span></span>
<span><span class="va">patient_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Charlie"</span>, <span class="st">"Diana"</span>, <span class="st">"Eve"</span><span class="op">)</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">30</span>, <span class="fl">35</span>, <span class="fl">40</span>, <span class="fl">45</span><span class="op">)</span>,</span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span><span class="op">)</span>,</span>
<span>  response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">patient_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patient_id    name age treatment response</span></span>
<span><span class="co">#&gt; 1          1   Alice  25         A     TRUE</span></span>
<span><span class="co">#&gt; 2          2     Bob  30         B     TRUE</span></span>
<span><span class="co">#&gt; 3          3 Charlie  35         A    FALSE</span></span>
<span><span class="co">#&gt; 4          4   Diana  40         B     TRUE</span></span>
<span><span class="co">#&gt; 5          5     Eve  45         A    FALSE</span></span>
<span></span>
<span><span class="co"># View structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">patient_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    5 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;  $ patient_id: int  1 2 3 4 5</span></span>
<span><span class="co">#&gt;  $ name      : chr  "Alice" "Bob" "Charlie" "Diana" ...</span></span>
<span><span class="co">#&gt;  $ age       : num  25 30 35 40 45</span></span>
<span><span class="co">#&gt;  $ treatment : chr  "A" "B" "A" "B" ...</span></span>
<span><span class="co">#&gt;  $ response  : logi  TRUE TRUE FALSE TRUE FALSE</span></span>
<span></span>
<span><span class="co"># Summary statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">patient_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;    patient_id     name                age    </span></span>
<span><span class="co">#&gt;  Min.   :1    Length:5           Min.   :25  </span></span>
<span><span class="co">#&gt;  1st Qu.:2    Class :character   1st Qu.:30  </span></span>
<span><span class="co">#&gt;  Median :3    Mode  :character   Median :35  </span></span>
<span><span class="co">#&gt;  Mean   :3                       Mean   :35  </span></span>
<span><span class="co">#&gt;  3rd Qu.:4                       3rd Qu.:40  </span></span>
<span><span class="co">#&gt;  Max.   :5                       Max.   :45  </span></span>
<span><span class="co">#&gt;   treatment          response      </span></span>
<span><span class="co">#&gt;  Length:5           Mode :logical  </span></span>
<span><span class="co">#&gt;  Class :character   FALSE:2        </span></span>
<span><span class="co">#&gt;  Mode  :character   TRUE :3        </span></span>
<span><span class="co">#&gt;                                    </span></span>
<span><span class="co">#&gt;                                    </span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p><strong>Please note:</strong></p>
<ul>
<li>Data frames are easily subset by index number using the square brackets notation <code>[]</code>, or by column name using the dollar sign <code>$</code>.</li>
<li>The arguments inside the square brackets are the <code>[row_number, column_number]</code>. If any of these is omitted, R assumes that all values are to be used.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Access columns</span></span>
<span><span class="va">patient_data</span><span class="op">$</span><span class="va">age</span></span>
<span><span class="co">#&gt; [1] 25 30 35 40 45</span></span>
<span><span class="va">patient_data</span><span class="op">[</span>, <span class="st">"name"</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "Alice"   "Bob"     "Charlie" "Diana"   "Eve"</span></span>
<span><span class="va">patient_data</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "Alice"   "Bob"     "Charlie" "Diana"   "Eve"</span></span>
<span></span>
<span><span class="co"># Access rows</span></span>
<span><span class="va">patient_data</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>           <span class="co"># First row</span></span>
<span><span class="co">#&gt;   patient_id  name age treatment response</span></span>
<span><span class="co">#&gt; 1          1 Alice  25         A     TRUE</span></span>
<span><span class="va">patient_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span>         <span class="co"># First three rows</span></span>
<span><span class="co">#&gt;   patient_id    name age treatment response</span></span>
<span><span class="co">#&gt; 1          1   Alice  25         A     TRUE</span></span>
<span><span class="co">#&gt; 2          2     Bob  30         B     TRUE</span></span>
<span><span class="co">#&gt; 3          3 Charlie  35         A    FALSE</span></span>
<span></span>
<span><span class="co"># Access specific cells</span></span>
<span><span class="va">patient_data</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span>          <span class="co"># Row 2, Column 3</span></span>
<span><span class="co">#&gt; [1] 30</span></span>
<span><span class="va">patient_data</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"age"</span><span class="op">]</span>      <span class="co"># Same, using column name</span></span>
<span><span class="co">#&gt; [1] 30</span></span>
<span></span>
<span><span class="co"># Subset by condition</span></span>
<span><span class="va">patient_data</span><span class="op">[</span><span class="va">patient_data</span><span class="op">$</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">30</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;   patient_id    name age treatment response</span></span>
<span><span class="co">#&gt; 3          3 Charlie  35         A    FALSE</span></span>
<span><span class="co">#&gt; 4          4   Diana  40         B     TRUE</span></span>
<span><span class="co">#&gt; 5          5     Eve  45         A    FALSE</span></span>
<span><span class="va">patient_data</span><span class="op">[</span><span class="va">patient_data</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;   patient_id    name age treatment response</span></span>
<span><span class="co">#&gt; 1          1   Alice  25         A     TRUE</span></span>
<span><span class="co">#&gt; 3          3 Charlie  35         A    FALSE</span></span>
<span><span class="co">#&gt; 5          5     Eve  45         A    FALSE</span></span></code></pre></div>
<div id="exploring-data-frames" class="section level4" number="1.3.3.1">
<h4>
<span class="header-section-number">1.3.3.1</span> Exploring Data Frames<a class="anchor" aria-label="anchor" href="#exploring-data-frames"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View first rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">patient_data</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patient_id  name age treatment response</span></span>
<span><span class="co">#&gt; 1          1 Alice  25         A     TRUE</span></span>
<span><span class="co">#&gt; 2          2   Bob  30         B     TRUE</span></span>
<span></span>
<span><span class="co"># Dimensions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">patient_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">patient_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">patient_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span></span>
<span><span class="co"># Column names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">patient_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "patient_id" "name"       "age"        "treatment" </span></span>
<span><span class="co">#&gt; [5] "response"</span></span></code></pre></div>
</div>
<div id="accessing-data-frame-elements" class="section level4" number="1.3.3.2">
<h4>
<span class="header-section-number">1.3.3.2</span> Accessing Data Frame Elements<a class="anchor" aria-label="anchor" href="#accessing-data-frame-elements"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Access column by name</span></span>
<span><span class="va">patient_data</span><span class="op">$</span><span class="va">name</span></span>
<span><span class="co">#&gt; [1] "Alice"   "Bob"     "Charlie" "Diana"   "Eve"</span></span>
<span></span>
<span><span class="co"># Access using brackets [row, column]</span></span>
<span><span class="va">patient_data</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">]</span>        <span class="co"># Row 1, column 3</span></span>
<span><span class="co">#&gt; [1] 25</span></span>
<span><span class="va">patient_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="op">]</span>       <span class="co"># First 2 rows, all columns</span></span>
<span><span class="co">#&gt;   patient_id  name age treatment response</span></span>
<span><span class="co">#&gt; 1          1 Alice  25         A     TRUE</span></span>
<span><span class="co">#&gt; 2          2   Bob  30         B     TRUE</span></span>
<span><span class="va">patient_data</span><span class="op">[</span>, <span class="st">"treatment"</span><span class="op">]</span>    <span class="co"># All rows, Mass column</span></span>
<span><span class="co">#&gt; [1] "A" "B" "A" "B" "A"</span></span>
<span></span>
<span><span class="co"># Subset data</span></span>
<span><span class="va">patient_data</span><span class="op">[</span><span class="va">patient_data</span><span class="op">$</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">30</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;   patient_id    name age treatment response</span></span>
<span><span class="co">#&gt; 3          3 Charlie  35         A    FALSE</span></span>
<span><span class="co">#&gt; 4          4   Diana  40         B     TRUE</span></span>
<span><span class="co">#&gt; 5          5     Eve  45         A    FALSE</span></span></code></pre></div>
</div>
</div>
<div id="lists" class="section level3" number="1.3.4">
<h3>
<span class="header-section-number">1.3.4</span> Lists<a class="anchor" aria-label="anchor" href="#lists"><i class="fas fa-link"></i></a>
</h3>
<p>Lists can contain elements of different types and structures.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a list</span></span>
<span><span class="va">experiment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  experiment_id <span class="op">=</span> <span class="st">"EXP001"</span>,</span>
<span>  date <span class="op">=</span> <span class="st">"2025-01-15"</span>,</span>
<span>  samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">patient_data</span>,</span>
<span>  validated <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Access list elements</span></span>
<span><span class="va">experiment</span><span class="op">$</span><span class="va">experiment_id</span></span>
<span><span class="co">#&gt; [1] "EXP001"</span></span>
<span><span class="va">experiment</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "EXP001"</span></span>
<span><span class="va">experiment</span><span class="op">[[</span><span class="st">"samples"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "S1" "S2" "S3"</span></span></code></pre></div>
</div>
<div id="factors" class="section level3" number="1.3.5">
<h3>
<span class="header-section-number">1.3.5</span> Factors<a class="anchor" aria-label="anchor" href="#factors"><i class="fas fa-link"></i></a>
</h3>
<p>Factors are variables in R which take on a limited number of different values- Such variables are often refered to as categorical variables.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create factor</span></span>
<span><span class="va">treatment_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Drug A"</span>, <span class="st">"Drug B"</span>, <span class="st">"Control"</span>, <span class="st">"Drug A"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">treatment_factor</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] Control Drug A  Drug B  Control Drug A </span></span>
<span><span class="co">#&gt; Levels: Control Drug A Drug B</span></span>
<span></span>
<span><span class="co"># Check levels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">treatment_factor</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Control" "Drug A"  "Drug B"</span></span>
<span></span>
<span><span class="co"># Ordered factors</span></span>
<span><span class="va">severity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mild"</span>, <span class="st">"Severe"</span>, <span class="st">"Moderate"</span>, <span class="st">"Mild"</span>, <span class="st">"Severe"</span><span class="op">)</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Severe"</span><span class="op">)</span>,</span>
<span>  ordered <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">severity</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] Mild     Severe   Moderate Mild     Severe  </span></span>
<span><span class="co">#&gt; Levels: Mild &lt; Moderate &lt; Severe</span></span></code></pre></div>
</div>
<div id="type-coercion" class="section level3" number="1.3.6">
<h3>
<span class="header-section-number">1.3.6</span> Type Coercion<a class="anchor" aria-label="anchor" href="#type-coercion"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Implicit coercion</span></span>
<span><span class="va">mixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="st">"three"</span>, <span class="fl">4</span><span class="op">)</span>  <span class="co"># All converted to character</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mixed</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "1"     "2"     "three" "4"</span></span>
<span></span>
<span><span class="co"># Explicit coercion</span></span>
<span><span class="va">numbers_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span><span class="op">)</span></span>
<span><span class="va">numbers_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">numbers_char</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">numbers_num</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4</span></span>
<span></span>
<span><span class="co"># Check types</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">mixed</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "character"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">mixed</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">mixed</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div id="exercise-1.2-data-structures" class="section level3" number="1.3.7">
<h3>
<span class="header-section-number">1.3.7</span> Exercise 1.2: Data Structures<a class="anchor" aria-label="anchor" href="#exercise-1.2-data-structures"><i class="fas fa-link"></i></a>
</h3>
<p>Create a data frame for a proteomic experiment with:</p>
<ul>
<li>10 protein IDs (P001 to P010)</li>
<li>Random abundance values between 100 and 5000</li>
<li>Random p-values between 0 and 1</li>
<li>Significance status (TRUE if p-value &lt; 0.05)</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Solution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>  <span class="co"># For reproducibility</span></span>
<span></span>
<span><span class="va">proteins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  protein_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%03d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  abundance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span>, min <span class="op">=</span> <span class="fl">100</span>, max <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  p_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">proteins</span><span class="op">$</span><span class="va">significant</span> <span class="op">&lt;-</span> <span class="va">proteins</span><span class="op">$</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">proteins</span><span class="op">)</span></span>
<span><span class="co">#&gt;    protein_id abundance   p_value significant</span></span>
<span><span class="co">#&gt; 1        P001   4582.55 0.4577418       FALSE</span></span>
<span><span class="co">#&gt; 2        P002   4691.67 0.7191123       FALSE</span></span>
<span><span class="co">#&gt; 3        P003   1502.08 0.9346722       FALSE</span></span>
<span><span class="co">#&gt; 4        P004   4169.19 0.2554288       FALSE</span></span>
<span><span class="co">#&gt; 5        P005   3244.55 0.4622928       FALSE</span></span>
<span><span class="co">#&gt; 6        P006   2643.57 0.9400145       FALSE</span></span>
<span><span class="co">#&gt; 7        P007   3709.28 0.9782264       FALSE</span></span>
<span><span class="co">#&gt; 8        P008    759.87 0.1174874       FALSE</span></span>
<span><span class="co">#&gt; 9        P009   3319.26 0.4749971       FALSE</span></span>
<span><span class="co">#&gt; 10       P010   3554.82 0.5603327       FALSE</span></span>
<span></span>
<span><span class="co"># Summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nNumber of significant proteins:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">proteins</span><span class="op">$</span><span class="va">significant</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of significant proteins: 0</span></span></code></pre></div>
</div>
</div>
<div id="day1-mod3" class="section level2" number="1.4">
<h2>
<span class="header-section-number">1.4</span> Module 3: Control Flow and Functions<a class="anchor" aria-label="anchor" href="#day1-mod3"><i class="fas fa-link"></i></a>
</h2>
<div id="conditional-statements" class="section level3" number="1.4.1">
<h3>
<span class="header-section-number">1.4.1</span> Conditional Statements<a class="anchor" aria-label="anchor" href="#conditional-statements"><i class="fas fa-link"></i></a>
</h3>
<p>Conditionals allow running commands only when certain conditions are TRUE. The syntax is: <code>if (condition) { code-block }</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if statement</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"x is greater than 5"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "x is greater than 5"</span></span>
<span></span>
<span><span class="co"># if-else</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">15</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"x is greater than 15"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"x is 15 or less"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "x is 15 or less"</span></span>
<span></span>
<span><span class="co"># if-else if-else</span></span>
<span><span class="va">score</span> <span class="op">&lt;-</span> <span class="fl">75</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">score</span> <span class="op">&gt;=</span> <span class="fl">90</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">grade</span> <span class="op">&lt;-</span> <span class="st">"A"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">score</span> <span class="op">&gt;=</span> <span class="fl">80</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">grade</span> <span class="op">&lt;-</span> <span class="st">"B"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">score</span> <span class="op">&gt;=</span> <span class="fl">70</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">grade</span> <span class="op">&lt;-</span> <span class="st">"C"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">grade</span> <span class="op">&lt;-</span> <span class="st">"F"</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Grade:"</span>, <span class="va">grade</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Grade: C"</span></span></code></pre></div>
<p>The <code>ifelse</code> function combines element-wise operations (vectorized) and filtering with a condition that is evaluated. The major advantage of the ifelse over the standard if-then-else statement is that it is vectorized. The syntax is: <code>ifelse (condition-to-test, value-for-true, value-for-false)</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Vectorized ifelse</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">categories</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">values</span> <span class="op">&gt;</span> <span class="fl">10</span>, <span class="st">"High"</span>, <span class="st">"Low"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">categories</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Low"  "Low"  "Low"  "High" "High"</span></span></code></pre></div>
</div>
<div id="loops" class="section level3" number="1.4.2">
<h3>
<span class="header-section-number">1.4.2</span> Loops<a class="anchor" aria-label="anchor" href="#loops"><i class="fas fa-link"></i></a>
</h3>
<p>R allows the implementation of <strong>loops</strong>, i.e. replicating instructions in an iterative way (also called cycles). The most common ones are <code>for ()</code> loops and <code>while ()</code> loops. The syntax for these loops is: <code>for (condition) { code-block } and while (condition) { code-block }</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for loop</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Iteration:"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "Iteration: 1"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 2"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 3"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 4"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 5"</span></span>
<span></span>
<span><span class="co"># Loop through vector</span></span>
<span><span class="va">proteins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ACTB"</span>, <span class="st">"GAPDH"</span>, <span class="st">"MYC"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">protein</span> <span class="kw">in</span> <span class="va">proteins</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Processing:"</span>, <span class="va">protein</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "Processing: ACTB"</span></span>
<span><span class="co">#&gt; [1] "Processing: GAPDH"</span></span>
<span><span class="co">#&gt; [1] "Processing: MYC"</span></span>
<span></span>
<span><span class="co"># while loop</span></span>
<span><span class="va">counter</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="va">counter</span> <span class="op">&lt;=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Counter:"</span>, <span class="va">counter</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">counter</span> <span class="op">&lt;-</span> <span class="va">counter</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "Counter: 1"</span></span>
<span><span class="co">#&gt; [1] "Counter: 2"</span></span>
<span><span class="co">#&gt; [1] "Counter: 3"</span></span>
<span><span class="co">#&gt; [1] "Counter: 4"</span></span>
<span><span class="co">#&gt; [1] "Counter: 5"</span></span>
<span></span>
<span><span class="co"># Mixing loop with condition</span></span>
<span><span class="va">numbers</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">num</span> <span class="kw">in</span> <span class="va">numbers</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">num</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">num</span>, <span class="st">"is even"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">num</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">2</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">num</span>, <span class="st">"is odd"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "1 is odd"</span></span>
<span><span class="co">#&gt; [1] "2 is even"</span></span>
<span><span class="co">#&gt; [1] "3 is odd"</span></span>
<span><span class="co">#&gt; [1] "4 is even"</span></span>
<span><span class="co">#&gt; [1] "5 is odd"</span></span>
<span><span class="co">#&gt; [1] "6 is even"</span></span>
<span><span class="co">#&gt; [1] "7 is odd"</span></span>
<span><span class="co">#&gt; [1] "8 is even"</span></span>
<span><span class="co">#&gt; [1] "9 is odd"</span></span>
<span><span class="co">#&gt; [1] "10 is even"</span></span></code></pre></div>
</div>
<div id="functions" class="section level3" number="1.4.3">
<h3>
<span class="header-section-number">1.4.3</span> Functions<a class="anchor" aria-label="anchor" href="#functions"><i class="fas fa-link"></i></a>
</h3>
<p>R allows defining new functions using the function command. The syntax (in pseudo-code) is the following:</p>
<p><code>my.function.name &lt;- function (argument1, argument2, ...) {    expression1   expression2   ...   return (value)   }</code></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic function</span></span>
<span><span class="va">greet</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">message</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Hello,"</span>, <span class="va">name</span>, <span class="st">"!"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">message</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">greet</span><span class="op">(</span><span class="st">"Alice"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Hello, Alice !"</span></span>
<span></span>
<span><span class="co"># Function with multiple parameters</span></span>
<span><span class="va">calculate_fold_change</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">treatment</span>, <span class="va">control</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fc</span> <span class="op">&lt;-</span> <span class="va">treatment</span> <span class="op">/</span> <span class="va">control</span></span>
<span>  <span class="va">log2_fc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">log2_fc</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">calculate_fold_change</span><span class="op">(</span>treatment <span class="op">=</span> <span class="fl">200</span>, control <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span></span>
<span><span class="co"># Function with default parameters</span></span>
<span><span class="va">normalize_abundance</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">abundance</span>, <span class="va">method</span> <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"median"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">normalized</span> <span class="op">&lt;-</span> <span class="va">abundance</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">abundance</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"mean"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">normalized</span> <span class="op">&lt;-</span> <span class="va">abundance</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">abundance</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Method must be 'median' or 'mean'"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">normalized</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span>, <span class="fl">400</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu">normalize_abundance</span><span class="op">(</span><span class="va">values</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3333333 0.6666667 1.0000000 1.3333333 1.6666667</span></span>
<span><span class="fu">normalize_abundance</span><span class="op">(</span><span class="va">values</span>, method <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3333333 0.6666667 1.0000000 1.3333333 1.6666667</span></span></code></pre></div>
</div>
<div id="apply-family-functions" class="section level3" number="1.4.4">
<h3>
<span class="header-section-number">1.4.4</span> Apply Family Functions<a class="anchor" aria-label="anchor" href="#apply-family-functions"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>apply</code> family of functions lets you perform calculations efficiently across rows, columns, or lists.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create sample data</span></span>
<span><span class="va">protein_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">150</span>, <span class="fl">200</span>, <span class="fl">250</span>, </span>
<span>    <span class="fl">110</span>, <span class="fl">160</span>, <span class="fl">210</span>, <span class="fl">260</span>,</span>
<span>    <span class="fl">120</span>, <span class="fl">170</span>, <span class="fl">220</span>, <span class="fl">270</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">protein_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sample1"</span>, <span class="st">"Sample2"</span>, <span class="st">"Sample3"</span>, <span class="st">"Sample4"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">protein_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Protein1"</span>, <span class="st">"Protein2"</span>, <span class="st">"Protein3"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">protein_matrix</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Sample1 Sample2 Sample3 Sample4</span></span>
<span><span class="co">#&gt; Protein1     100     150     200     250</span></span>
<span><span class="co">#&gt; Protein2     110     160     210     260</span></span>
<span><span class="co">#&gt; Protein3     120     170     220     270</span></span>
<span></span>
<span><span class="co"># apply: apply function to rows or columns</span></span>
<span><span class="va">row_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">protein_matrix</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span>  <span class="co"># 1 = rows</span></span>
<span><span class="va">col_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">protein_matrix</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span>  <span class="co"># 2 = columns</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">row_means</span><span class="op">)</span></span>
<span><span class="co">#&gt; Protein1 Protein2 Protein3 </span></span>
<span><span class="co">#&gt;      175      185      195</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">col_means</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample1 Sample2 Sample3 Sample4 </span></span>
<span><span class="co">#&gt;     110     160     210     260</span></span>
<span></span>
<span><span class="co"># lapply: apply function to list, returns list</span></span>
<span><span class="va">my_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, b <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span>, c <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">list_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">my_list</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">list_means</span><span class="op">)</span></span>
<span><span class="co">#&gt; $a</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $b</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $c</span></span>
<span><span class="co">#&gt; [1] 13</span></span>
<span></span>
<span><span class="co"># sapply: simplified version of lapply</span></span>
<span><span class="va">vector_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">my_list</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">vector_means</span><span class="op">)</span></span>
<span><span class="co">#&gt;  a  b  c </span></span>
<span><span class="co">#&gt;  3  8 13</span></span></code></pre></div>
</div>
<div id="exercise-1.3-functions-and-loops" class="section level3" number="1.4.5">
<h3>
<span class="header-section-number">1.4.5</span> Exercise 1.3: Functions and Loops<a class="anchor" aria-label="anchor" href="#exercise-1.3-functions-and-loops"><i class="fas fa-link"></i></a>
</h3>
<p>Write a function that:</p>
<ol style="list-style-type: decimal">
<li>Takes a vector of protein abundances</li>
<li>Calculates the coefficient of variation (CV = sd/mean * 100)</li>
<li>Returns “Pass” if CV &lt; 20%, “Fail” otherwise</li>
</ol>
<p>Apply this function to multiple samples using a loop.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Solution</span></span>
<span><span class="va">calculate_cv_status</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">abundances</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cv</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">abundances</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">abundances</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">cv</span> <span class="op">&lt;</span> <span class="fl">20</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">status</span> <span class="op">&lt;-</span> <span class="st">"Pass"</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">status</span> <span class="op">&lt;-</span> <span class="st">"Fail"</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">cv</span>, <span class="fl">2</span><span class="op">)</span>, status <span class="op">=</span> <span class="va">status</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create sample data</span></span>
<span><span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  sample1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">105</span>, <span class="fl">98</span>, <span class="fl">102</span>, <span class="fl">99</span><span class="op">)</span>,</span>
<span>  sample2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">150</span>, <span class="fl">90</span>, <span class="fl">200</span>, <span class="fl">80</span><span class="op">)</span>,</span>
<span>  sample3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">505</span>, <span class="fl">498</span>, <span class="fl">502</span>, <span class="fl">496</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply function</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">sample_name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">calculate_cv_status</span><span class="op">(</span><span class="va">sample_data</span><span class="op">[[</span><span class="va">sample_name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">sample_name</span>, <span class="st">"- CV:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">cv</span>, <span class="st">"% - Status:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">status</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; sample1 - CV: 2.75 % - Status: Pass </span></span>
<span><span class="co">#&gt; sample2 - CV: 40.56 % - Status: Fail </span></span>
<span><span class="co">#&gt; sample3 - CV: 0.7 % - Status: Pass</span></span></code></pre></div>
</div>
</div>
<div id="day1-mod5" class="section level2" number="1.5">
<h2>
<span class="header-section-number">1.5</span> Module 4: Data Visualization with <code>ggplot2</code><a class="anchor" aria-label="anchor" href="#day1-mod5"><i class="fas fa-link"></i></a>
</h2>
<p>In this module, we will explore how to visualize data using <strong>ggplot2</strong>, one of the most powerful and flexible plotting systems in R.It is based on the “grammar of graphics” framework, which emphasizes the modular construction of a plot using different layers and components ((ggplot2 online documentation here)[<a href="https://ggplot2.tidyverse.org/" class="uri">https://ggplot2.tidyverse.org/</a>]).</p>
<p>In this module, we will explore how to visualize data using <strong>ggplot2</strong>, one of the most powerful and flexible plotting systems in R. <strong>ggplot2</strong> is based on the <strong>“grammar of graphics”</strong>, a framework that builds plots by <em>adding layers</em> (a bit like stacking transparent sheets), each adding a new element (data, axes, shapes, colors, etc.).</p>
<p>You can read more about the grammar concept in the official <a href="https://ggplot2.tidyverse.org/">ggplot2 documentation</a>, or check the handy <a href="https://rstudio.github.io/cheatsheets/data-visualization.pdf">ggplot2 cheatsheet</a>.</p>
<hr>
<div id="loading-required-packages" class="section level3" number="1.5.1">
<h3>
<span class="header-section-number">1.5.1</span> Loading Required Packages<a class="anchor" aria-label="anchor" href="#loading-required-packages"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div id="understanding-the-ggplot2-structure" class="section level3" number="1.5.2">
<h3>
<span class="header-section-number">1.5.2</span> Understanding the <code>ggplot2</code> structure<a class="anchor" aria-label="anchor" href="#understanding-the-ggplot2-structure"><i class="fas fa-link"></i></a>
</h3>
<p>Every ggplot is built with <strong>three key components</strong>:</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="29%">
<col width="39%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Component</th>
<th>What it defines</th>
<th>Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Data</strong></td>
<td>The dataset you want to plot</td>
<td><code>protein_data</code></td>
</tr>
<tr class="even">
<td><strong>Aesthetics (<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>)</strong></td>
<td>How variables are mapped to visual properties</td>
<td><code>aes(x = condition, y = abundance)</code></td>
</tr>
<tr class="odd">
<td><strong>Geometric objects (<code>geom_*()</code>)</strong></td>
<td>What kind of plot to draw</td>
<td>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>
</td>
</tr>
</tbody>
</table></div>
<p>You can think of it as a sentence:</p>
<blockquote>
<p>“Use this <strong>data</strong>, map these <strong>variables</strong> to the axes, and draw <strong>this geometry</strong>.”</p>
</blockquote>
<p>A plot is usually constructed in layers:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">protein_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">abundance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Each <code>+</code> adds a new layer or visual element (title, theme, labels, etc.).</p>
<hr>
</div>
<div id="example-dataset" class="section level3" number="1.5.3">
<h3>
<span class="header-section-number">1.5.3</span> Example Dataset<a class="anchor" aria-label="anchor" href="#example-dataset"><i class="fas fa-link"></i></a>
</h3>
<p>We’ll first create an example dataset representing protein abundance under two conditions: <em>Control</em> and <em>Treatment</em>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate realistic protein abundance data</span></span>
<span></span>
<span><span class="va">n_proteins</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="va">protein_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>protein_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%03d"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_proteins</span><span class="op">)</span><span class="op">)</span>,</span>
<span>abundance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_proteins</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="fl">1000</span>, sd <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>,   <span class="co"># Control group</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_proteins</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="fl">1300</span>, sd <span class="op">=</span> <span class="fl">180</span><span class="op">)</span>    <span class="co"># Treatment group</span></span>
<span><span class="op">)</span>,</span>
<span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Treatment"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n_proteins</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add a few outliers to make the data more realistic</span></span>
<span><span class="va">outlier_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_proteins</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">protein_data</span><span class="op">$</span><span class="va">abundance</span><span class="op">[</span><span class="va">outlier_indices</span><span class="op">]</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">protein_data</span><span class="op">$</span><span class="va">abundance</span><span class="op">[</span><span class="va">outlier_indices</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1.5</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">protein_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   protein_id abundance condition</span></span>
<span><span class="co">#&gt; 1       P001 1205.6438   Control</span></span>
<span><span class="co">#&gt; 2       P002  915.2953   Control</span></span>
<span><span class="co">#&gt; 3       P003 1054.4693   Control</span></span>
<span><span class="co">#&gt; 4       P004 1094.9294   Control</span></span>
<span><span class="co">#&gt; 5       P005 1060.6402   Control</span></span>
<span><span class="co">#&gt; 6       P006  984.0813   Control</span></span></code></pre></div>
<hr>
</div>
<div id="histogram-distribution-of-protein-abundance" class="section level3" number="1.5.4">
<h3>
<span class="header-section-number">1.5.4</span> Histogram: Distribution of Protein Abundance<a class="anchor" aria-label="anchor" href="#histogram-distribution-of-protein-abundance"><i class="fas fa-link"></i></a>
</h3>
<p>A <strong>histogram</strong> helps visualize the distribution of continuous variables such as protein abundance.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">protein_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abundance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">100</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Distribution of Protein Abundance"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Abundance"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Count"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="day1_intro_to_r_files/figure-html/ggplot-histogram-1.png" width="672"></div>
<hr>
</div>
<div id="boxplot-comparing-conditions" class="section level3" number="1.5.5">
<h3>
<span class="header-section-number">1.5.5</span> Boxplot: Comparing Conditions<a class="anchor" aria-label="anchor" href="#boxplot-comparing-conditions"><i class="fas fa-link"></i></a>
</h3>
<p>A <strong>boxplot</strong> provides a compact summary of abundance values across conditions.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">protein_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">abundance</span>, fill <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Protein Abundance by Condition"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Condition"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Abundance"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="day1_intro_to_r_files/figure-html/ggplot-boxplot-1.png" width="672"></div>
<hr>
</div>
<div id="scatter-plot-individual-points-with-mean-values" class="section level3" number="1.5.6">
<h3>
<span class="header-section-number">1.5.6</span> Scatter Plot: Individual Points with Mean Values<a class="anchor" aria-label="anchor" href="#scatter-plot-individual-points-with-mean-values"><i class="fas fa-link"></i></a>
</h3>
<p>A <strong>scatter plot</strong> with <strong>jittering</strong> can display individual data points while avoiding overlap. Adding <strong>mean points</strong> provides an overview of group averages.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">protein_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">abundance</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">18</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Abundance per Condition with Mean Values"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Condition"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Abundance"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="day1_intro_to_r_files/figure-html/ggplot-scatter-1.png" width="672"></div>
<hr>
</div>
<div id="density-plot-distribution-by-condition" class="section level3" number="1.5.7">
<h3>
<span class="header-section-number">1.5.7</span> Density Plot: Distribution by Condition<a class="anchor" aria-label="anchor" href="#density-plot-distribution-by-condition"><i class="fas fa-link"></i></a>
</h3>
<p>A <strong>density plot</strong> shows the smoothed distribution of abundance values for each condition.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">protein_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abundance</span>, fill <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Density Plot of Protein Abundance by Condition"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Abundance"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="day1_intro_to_r_files/figure-html/ggplot-density-1.png" width="672"></div>
<hr>
</div>
<div id="summary" class="section level3" number="1.5.8">
<h3>
<span class="header-section-number">1.5.8</span> Summary<a class="anchor" aria-label="anchor" href="#summary"><i class="fas fa-link"></i></a>
</h3>
<p>In this module, you learned how to:</p>
<ul>
<li>Build ggplot2 plots layer by layer.</li>
<li>Use <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> to map variables to axes and colors.</li>
<li>Visualize distributions using histograms and density plots</li>
<li>Compare groups using boxplots</li>
<li>Display individual data points with jitter and summary statistics</li>
</ul>
<p>These visualizations are essential for exploring proteomics data and identifying trends or outliers before further statistical analysis.</p>
</div>
</div>
<div id="module-5-importing-and-exploring-data" class="section level2" number="1.6">
<h2>
<span class="header-section-number">1.6</span> Module 5: Importing and Exploring Data<a class="anchor" aria-label="anchor" href="#module-5-importing-and-exploring-data"><i class="fas fa-link"></i></a>
</h2>
<p>Most R users need to load their own datasets, usually saved as table files (e.g. Excel, or .csv files), to be able to analyse and manipulate them. After the analysis, the results need to be exported/saved (e.g. to view or use with other software).</p>
<div id="reading-common-file-types" class="section level3" number="1.6.1">
<h3>
<span class="header-section-number">1.6.1</span> Reading common file types<a class="anchor" aria-label="anchor" href="#reading-common-file-types"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CSV / TSV (readr is faster and friendlier than base R)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read a comma-delimited file (CSV)</span></span>
<span><span class="va">proteins_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/proteins.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read a tab-delimited file (TSV)</span></span>
<span><span class="va">proteins_tsv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_tsv</a></span><span class="op">(</span><span class="st">"data/proteins.tsv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Base R alternatives (fine, but less convenient)</span></span>
<span><span class="va">proteins_csv_base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/proteins.csv"</span><span class="op">)</span>              <span class="co"># comma</span></span>
<span><span class="va">proteins_tsv_base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="st">"data/proteins.tsv"</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span><span class="co"># tab</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Excel (readxl does not require Java)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reads first sheet by default; or set sheet = "Sheet1"</span></span>
<span><span class="va">proteins_xlsx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/proteins.xlsx"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="saving-data" class="section level3" number="1.6.2">
<h3>
<span class="header-section-number">1.6.2</span> Saving data<a class="anchor" aria-label="anchor" href="#saving-data"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CSV / TSV</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="va">proteins_csv</span>, <span class="st">"results/proteins_clean.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_tsv</a></span><span class="op">(</span><span class="va">proteins_csv</span>, <span class="st">"results/proteins_clean.tsv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Excel (simple writer)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ropensci.r-universe.dev/writexl">writexl</a></span><span class="op">)</span></span>
<span><span class="fu">write_xlsx</span><span class="op">(</span><span class="va">proteins_csv</span>, <span class="st">"results/proteins_clean.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># R native (best for workflows, preserves classes)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">proteins_csv</span>, <span class="st">"results/proteins_clean.rds"</span><span class="op">)</span></span>
<span><span class="co"># Later:</span></span>
<span><span class="va">reloaded</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"results/proteins_clean.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="basic-data-exploration" class="section level3" number="1.6.3">
<h3>
<span class="header-section-number">1.6.3</span> Basic Data Exploration<a class="anchor" aria-label="anchor" href="#basic-data-exploration"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">protein_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  protein_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>  abundance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">1000</span>, sd <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span>  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Treatment"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dimensions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">protein_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 100   3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">protein_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">protein_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span></span>
<span><span class="co"># First and last rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">protein_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   protein_id abundance condition</span></span>
<span><span class="co">#&gt; 1         P1  887.9049   Control</span></span>
<span><span class="co">#&gt; 2         P2  953.9645   Control</span></span>
<span><span class="co">#&gt; 3         P3 1311.7417   Control</span></span>
<span><span class="co">#&gt; 4         P4 1014.1017   Control</span></span>
<span><span class="co">#&gt; 5         P5 1025.8575   Control</span></span>
<span><span class="co">#&gt; 6         P6 1343.0130   Control</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">protein_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;     protein_id abundance condition</span></span>
<span><span class="co">#&gt; 95         P95 1272.1305 Treatment</span></span>
<span><span class="co">#&gt; 96         P96  879.9481 Treatment</span></span>
<span><span class="co">#&gt; 97         P97 1437.4666 Treatment</span></span>
<span><span class="co">#&gt; 98         P98 1306.5221 Treatment</span></span>
<span><span class="co">#&gt; 99         P99  952.8599 Treatment</span></span>
<span><span class="co">#&gt; 100       P100  794.7158 Treatment</span></span>
<span></span>
<span><span class="co"># Summary statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">protein_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   protein_id          abundance       condition        </span></span>
<span><span class="co">#&gt;  Length:100         Min.   : 538.2   Length:100        </span></span>
<span><span class="co">#&gt;  Class :character   1st Qu.: 901.2   Class :character  </span></span>
<span><span class="co">#&gt;  Mode  :character   Median :1012.4   Mode  :character  </span></span>
<span><span class="co">#&gt;                     Mean   :1018.1                     </span></span>
<span><span class="co">#&gt;                     3rd Qu.:1138.4                     </span></span>
<span><span class="co">#&gt;                     Max.   :1437.5</span></span>
<span></span>
<span><span class="co"># Table for categorical data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">protein_data</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Control Treatment </span></span>
<span><span class="co">#&gt;        50        50</span></span></code></pre></div>
</div>
</div>
<div id="module-6-data-wrangling-with-tidyverse" class="section level2" number="1.7">
<h2>
<span class="header-section-number">1.7</span> Module 6: Data Wrangling with tidyverse<a class="anchor" aria-label="anchor" href="#module-6-data-wrangling-with-tidyverse"><i class="fas fa-link"></i></a>
</h2>
<div id="introduction-to-tidyverse" class="section level3" number="1.7.1">
<h3>
<span class="header-section-number">1.7.1</span> Introduction to tidyverse<a class="anchor" aria-label="anchor" href="#introduction-to-tidyverse"><i class="fas fa-link"></i></a>
</h3>
<p><strong>What is tidyverse?</strong></p>
<ul>
<li>Collection of R packages for data science</li>
<li>Consistent syntax and design philosophy</li>
<li>Main packages: dplyr, tidyr, ggplot2, readr</li>
</ul>
<p><strong>Why tidyverse?</strong></p>
<ul>
<li>Readable, intuitive code</li>
<li>Pipe operator <code>%&gt;%</code> for chaining operations</li>
<li>Faster learning curve</li>
<li>Industry standard</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div id="the-pipe-operator" class="section level3" number="1.7.2">
<h3>
<span class="header-section-number">1.7.2</span> The Pipe Operator %&gt;%<a class="anchor" aria-label="anchor" href="#the-pipe-operator"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Traditional approach:</strong></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt; [1] 0.2079181</span></span></code></pre></div>
<p><strong>With pipe operator from <code>tidyverse</code> (<code>magrittr</code>):</strong></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt; [1] 0.2079181</span></span></code></pre></div>
<p><strong>Read as:</strong> “Take x, THEN take square root, THEN take log10, THEN calculate mean”</p>
<hr>
</div>
<div id="your-actual-proteomics-data-structure" class="section level3" number="1.7.3">
<h3>
<span class="header-section-number">1.7.3</span> Your Actual Proteomics Data Structure<a class="anchor" aria-label="anchor" href="#your-actual-proteomics-data-structure"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate your data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">proteomics_data</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>    path <span class="op">=</span> <span class="st">"examples/2126001_Protein Export_ex.xlsx"</span>, <span class="co"># this should be the file example that genethon provided</span></span>
<span>    skip <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Drop completely empty columns (all NA)</span></span>
<span><span class="va">proteomics_data</span> <span class="op">&lt;-</span> <span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">proteomics_data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 10</span></span>
<span><span class="co">#&gt;   Accession  Gene       `Peptide count` `Unique peptides`</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;                &lt;dbl&gt;             &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 F1LMU0     F1LMU0                 338               138</span></span>
<span><span class="co">#&gt; 2 G3V8V3     G3V8V3                 146               113</span></span>
<span><span class="co">#&gt; 3 A0A0G2JSP8 A0A0G2JSP8             117               109</span></span>
<span><span class="co">#&gt; 4 Q64578     AT2A1                  126                89</span></span>
<span><span class="co">#&gt; 5 D4AEH9     D4AEH9                  87                83</span></span>
<span><span class="co">#&gt; 6 P15429     ENOB                   110                83</span></span>
<span><span class="co">#&gt; # ℹ 6 more variables: `Confidence score` &lt;dbl&gt;, Mass &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Description &lt;chr&gt;, `2126001_029_F5` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `2126001_359_F9` &lt;dbl&gt;, `2126001_401_F1` &lt;dbl&gt;</span></span></code></pre></div>
<p>Good practice: Convert all column names to lowercase and replace spaces with underscores <code>_</code>, to keep the naming of colmuns cleaner and more consistent.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Clean column names: lowercase + underscores</span></span>
<span><span class="co">#colnames(proteomics_data) &lt;- tolower(colnames(proteomics_data))</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">proteomics_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">proteomics_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div id="dplyr-grammar-of-data-manipulation" class="section level3" number="1.7.4">
<h3>
<span class="header-section-number">1.7.4</span> dplyr: Grammar of Data Manipulation<a class="anchor" aria-label="anchor" href="#dplyr-grammar-of-data-manipulation"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Key Functions:</strong></p>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> - Choose columns</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> - Choose rows based on conditions</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> - Create or modify columns</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> - Sort data</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> - Calculate summary statistics</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> - Group data for operations</li>
</ul>
<hr>
</div>
<div id="select-choose-columns" class="section level3" number="1.7.5">
<h3>
<span class="header-section-number">1.7.5</span> select(): Choose Columns<a class="anchor" aria-label="anchor" href="#select-choose-columns"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select specific columns</span></span>
<span><span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accession</span>, <span class="va">gene</span>, <span class="va">mass</span>, <span class="va">`2126001_029_f5`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 4</span></span>
<span><span class="co">#&gt;   accession  gene          mass `2126001_029_f5`</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 F1LMU0     F1LMU0     222850.        25114306.</span></span>
<span><span class="co">#&gt; 2 G3V8V3     G3V8V3      97288.        18519365.</span></span>
<span><span class="co">#&gt; 3 A0A0G2JSP8 A0A0G2JSP8  43019.       897562438.</span></span>
<span></span>
<span><span class="co"># Select range of columns</span></span>
<span><span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accession</span><span class="op">:</span><span class="va">mass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 6</span></span>
<span><span class="co">#&gt;   accession  gene       peptide_count unique_peptides</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;              &lt;dbl&gt;           &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 F1LMU0     F1LMU0               338             138</span></span>
<span><span class="co">#&gt; 2 G3V8V3     G3V8V3               146             113</span></span>
<span><span class="co">#&gt; 3 A0A0G2JSP8 A0A0G2JSP8           117             109</span></span>
<span><span class="co">#&gt; # ℹ 2 more variables: confidence_score &lt;dbl&gt;, mass &lt;dbl&gt;</span></span>
<span></span>
<span><span class="co"># Select columns containing "sample"</span></span>
<span><span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accession</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"f5"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span><span class="co">#&gt;   accession  `2126001_029_f5`</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                 &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 F1LMU0            25114306.</span></span>
<span><span class="co">#&gt; 2 G3V8V3            18519365.</span></span>
<span><span class="co">#&gt; 3 A0A0G2JSP8       897562438.</span></span></code></pre></div>
<hr>
</div>
<div id="filter-choose-rows" class="section level3" number="1.7.6">
<h3>
<span class="header-section-number">1.7.6</span> filter(): Choose Rows<a class="anchor" aria-label="anchor" href="#filter-choose-rows"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter high mass proteins</span></span>
<span><span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mass</span> <span class="op">&gt;</span> <span class="fl">100000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accession</span>, <span class="va">gene</span>, <span class="va">mass</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 87 × 3</span></span>
<span><span class="co">#&gt;    accession  gene          mass</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 F1LMU0     F1LMU0     222850.</span></span>
<span><span class="co">#&gt;  2 Q64578     AT2A1      109409.</span></span>
<span><span class="co">#&gt;  3 D4AEH9     D4AEH9     174331.</span></span>
<span><span class="co">#&gt;  4 G3V7K1     G3V7K1     164712.</span></span>
<span><span class="co">#&gt;  5 A0A0G2K5P5 A0A0G2K5P5 187602.</span></span>
<span><span class="co">#&gt;  6 D3ZA38     D3ZA38     128936.</span></span>
<span><span class="co">#&gt;  7 Q03626     MUG1       165326 </span></span>
<span><span class="co">#&gt;  8 Q8R4I6     Q8R4I6     103013.</span></span>
<span><span class="co">#&gt;  9 D3ZHA0     FLNC       290984.</span></span>
<span><span class="co">#&gt; 10 A0A096MK15 A0A096MK15 772118.</span></span>
<span><span class="co">#&gt; # ℹ 77 more rows</span></span>
<span></span>
<span><span class="co"># Multiple conditions (AND)</span></span>
<span><span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mass</span> <span class="op">&gt;</span> <span class="fl">100000</span> <span class="op">&amp;</span> <span class="va">peptide_count</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accession</span>, <span class="va">gene</span>, <span class="va">mass</span>, <span class="va">peptide_count</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 7 × 4</span></span>
<span><span class="co">#&gt;   accession  gene          mass peptide_count</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 F1LMU0     F1LMU0     222850.           338</span></span>
<span><span class="co">#&gt; 2 Q64578     AT2A1      109409.           126</span></span>
<span><span class="co">#&gt; 3 A0A096MK15 A0A096MK15 772118.           133</span></span>
<span><span class="co">#&gt; 4 F1LRV9     F1LRV9     223400.           240</span></span>
<span><span class="co">#&gt; 5 G3V6E1     G3V6E1     219575.           173</span></span>
<span><span class="co">#&gt; 6 F1LMY4     RYR1       565491.           104</span></span>
<span><span class="co">#&gt; 7 A0A0G2K5J1 A0A0G2K5J1 563314.           102</span></span>
<span></span>
<span><span class="co"># OR conditions</span></span>
<span><span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mass</span> <span class="op">&gt;</span> <span class="fl">200000</span> <span class="op">|</span> <span class="va">peptide_count</span> <span class="op">&gt;</span> <span class="fl">300</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accession</span>, <span class="va">gene</span>, <span class="va">mass</span>, <span class="va">peptide_count</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 29 × 4</span></span>
<span><span class="co">#&gt;    accession  gene          mass peptide_count</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 F1LMU0     F1LMU0     222850.           338</span></span>
<span><span class="co">#&gt;  2 D3ZHA0     FLNC       290984.            55</span></span>
<span><span class="co">#&gt;  3 A0A096MK15 A0A096MK15 772118.           133</span></span>
<span><span class="co">#&gt;  4 F1LRV9     F1LRV9     223400.           240</span></span>
<span><span class="co">#&gt;  5 A0A0G2JU96 A0A0G2JU96 571866.            34</span></span>
<span><span class="co">#&gt;  6 M0R9L0     M0R9L0     220194.            28</span></span>
<span><span class="co">#&gt;  7 A0A0G2K7B6 A0A0G2K7B6 242460.            24</span></span>
<span><span class="co">#&gt;  8 F7F9U6     F7F9U6     517417.            16</span></span>
<span><span class="co">#&gt;  9 A0A0G2JUP3 A0A0G2JUP3 815466.             8</span></span>
<span><span class="co">#&gt; 10 G3V6E1     G3V6E1     219575.           173</span></span>
<span><span class="co">#&gt; # ℹ 19 more rows</span></span></code></pre></div>
<hr>
</div>
<div id="mutate-create-new-columns" class="section level3" number="1.7.7">
<h3>
<span class="header-section-number">1.7.7</span> mutate(): Create New Columns<a class="anchor" aria-label="anchor" href="#mutate-create-new-columns"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate log10 transformed values</span></span>
<span><span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>log10_mass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accession</span>, <span class="va">mass</span>, <span class="va">log10_mass</span>, <span class="va">`2126001_029_f5`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 4</span></span>
<span><span class="co">#&gt;   accession     mass log10_mass `2126001_029_f5`</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 F1LMU0     222850.       5.35        25114306.</span></span>
<span><span class="co">#&gt; 2 G3V8V3      97288.       4.99        18519365.</span></span>
<span><span class="co">#&gt; 3 A0A0G2JSP8  43019.       4.63       897562438.</span></span></code></pre></div>
<hr>
</div>
<div id="arrange-sort-data" class="section level3" number="1.7.8">
<h3>
<span class="header-section-number">1.7.8</span> arrange(): Sort Data<a class="anchor" aria-label="anchor" href="#arrange-sort-data"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sort by mass (ascending)</span></span>
<span><span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accession</span>, <span class="va">gene</span>, <span class="va">mass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span><span class="co">#&gt;   accession gene    mass</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 P29418    ATP5E  5767.</span></span>
<span><span class="co">#&gt; 2 Q9JJW3    ATPMK  6408.</span></span>
<span><span class="co">#&gt; 3 A9UMV7    A9UMV7 6539.</span></span>
<span></span>
<span><span class="co"># Sort descending</span></span>
<span><span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accession</span>, <span class="va">gene</span>, <span class="va">mass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span><span class="co">#&gt;   accession  gene          mass</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 A0A0G2JUP3 A0A0G2JUP3 815466.</span></span>
<span><span class="co">#&gt; 2 A0A096MK15 A0A096MK15 772118.</span></span>
<span><span class="co">#&gt; 3 F1M1J2     F1M1J2     623402.</span></span>
<span></span>
<span><span class="co"># Sort by multiple columns</span></span>
<span><span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">peptide_count</span><span class="op">)</span>, <span class="va">mass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accession</span>, <span class="va">peptide_count</span>, <span class="va">mass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span><span class="co">#&gt;   accession peptide_count    mass</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;             &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 F1LMU0              338 222850.</span></span>
<span><span class="co">#&gt; 2 F1LRV9              240 223400.</span></span>
<span><span class="co">#&gt; 3 G3V6E1              173 219575.</span></span></code></pre></div>
<hr>
</div>
<div id="summarize-calculate-statistics" class="section level3" number="1.7.9">
<h3>
<span class="header-section-number">1.7.9</span> summarize(): Calculate Statistics<a class="anchor" aria-label="anchor" href="#summarize-calculate-statistics"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate summary statistics</span></span>
<span><span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    n_proteins <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    mean_mass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span>,</span>
<span>    median_mass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span>,</span>
<span>    sd_mass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span>,</span>
<span>    mean_intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`2126001_029_f5`</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 5</span></span>
<span><span class="co">#&gt;   n_proteins mean_mass median_mass sd_mass mean_intensity</span></span>
<span><span class="co">#&gt;        &lt;int&gt;     &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1        824    57788.      39318.  75984.       3059149.</span></span>
<span></span>
<span><span class="co"># Multiple samples</span></span>
<span><span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    mean_s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`2126001_029_f5`</span><span class="op">)</span>,</span>
<span>    mean_s2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`2126001_359_f9`</span><span class="op">)</span>,</span>
<span>    cv_s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">`2126001_029_f5`</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`2126001_029_f5`</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span><span class="co">#&gt;    mean_s1  mean_s2 cv_s1</span></span>
<span><span class="co">#&gt;      &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 3059149. 3367563. 1102.</span></span></code></pre></div>
<hr>
</div>
<div id="group_by-grouped-operations" class="section level3" number="1.7.10">
<h3>
<span class="header-section-number">1.7.10</span> group_by(): Grouped Operations<a class="anchor" aria-label="anchor" href="#group_by-grouped-operations"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create groups based on mass</span></span>
<span><span class="va">proteomics_data_grouped</span> <span class="op">&lt;-</span> <span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    mass_category <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">mass</span> <span class="op">&lt;</span> <span class="fl">50000</span> <span class="op">~</span> <span class="st">"Low"</span>,</span>
<span>      <span class="va">mass</span> <span class="op">&lt;</span> <span class="fl">150000</span> <span class="op">~</span> <span class="st">"Medium"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"High"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate statistics by group</span></span>
<span><span class="va">proteomics_data_grouped</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">mass_category</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    n_proteins <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    mean_peptides <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">peptide_count</span><span class="op">)</span>,</span>
<span>    mean_confidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">confidence_score</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 4</span></span>
<span><span class="co">#&gt;   mass_category n_proteins mean_peptides mean_confidence</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;              &lt;int&gt;         &lt;dbl&gt;           &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 High                  43         45.8            4136.</span></span>
<span><span class="co">#&gt; 2 Low                  529          8.71            814.</span></span>
<span><span class="co">#&gt; 3 Medium               252         13.6            1176.</span></span></code></pre></div>
<hr>
</div>
<div id="combining-operations-pipeline" class="section level3" number="1.7.11">
<h3>
<span class="header-section-number">1.7.11</span> Combining Operations: Pipeline<a class="anchor" aria-label="anchor" href="#combining-operations-pipeline"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Complete analysis pipeline</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Filter high confidence proteins</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">confidence_score</span> <span class="op">&gt;</span> <span class="fl">10000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Calculate mean intensity across samples</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    mean_intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"sample"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Keep relevant columns</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">accession</span>, <span class="va">gene</span>, <span class="va">mass</span>, <span class="va">confidence_score</span>, <span class="va">mean_intensity</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Sort by mean intensity</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">mean_intensity</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   accession  gene       mass confidence_score mean_intensity</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 F1LMU0     F1LMU0   2.23e5           40162.            NaN</span></span>
<span><span class="co">#&gt; 2 G3V8V3     G3V8V3   9.73e4           15646.            NaN</span></span>
<span><span class="co">#&gt; 3 A0A0G2JSP8 A0A0G2J… 4.30e4           15567.            NaN</span></span>
<span><span class="co">#&gt; 4 Q64578     AT2A1    1.09e5           14102.            NaN</span></span>
<span><span class="co">#&gt; 5 P15429     ENOB     4.70e4           12564.            NaN</span></span>
<span><span class="co">#&gt; 6 P05065     ALDOA    3.94e4           11642.            NaN</span></span></code></pre></div>
<hr>
</div>
<div id="tidyr-reshaping-data" class="section level3" number="1.7.12">
<h3>
<span class="header-section-number">1.7.12</span> tidyr: Reshaping Data<a class="anchor" aria-label="anchor" href="#tidyr-reshaping-data"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Key Functions:</strong></p>
<ul>
<li>
<code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> - Wide to long format</li>
<li>
<code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> - Long to wide format</li>
<li>
<code><a href="https://tidyr.tidyverse.org/reference/separate.html">separate()</a></code> - Split one column into multiple</li>
<li>
<code><a href="https://tidyr.tidyverse.org/reference/unite.html">unite()</a></code> - Combine columns</li>
</ul>
<p><strong>Why reshape?</strong> Different analyses and visualizations require different formats</p>
<hr>
</div>
<div id="wide-vs-long-format" class="section level3" number="1.7.13">
<h3>
<span class="header-section-number">1.7.13</span> Wide vs Long Format<a class="anchor" aria-label="anchor" href="#wide-vs-long-format"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Wide format (your current data):</strong></p>
<pre><code>accession  `2126001_029_f5`  `2126001_359_f9`  sample_3
F1LMU0     2511430   8316460   3577492
G3V8V3     1851936   2066635   2986710</code></pre>
<p><strong>Long format:</strong></p>
<pre><code>accession  Sample     Intensity
F1LMU0     `2126001_029_f5`   2511430
F1LMU0     `2126001_359_f9`   8316460
F1LMU0     sample_3   3577492
G3V8V3     `2126001_029_f5`   1851936</code></pre>
<hr>
</div>
<div id="pivot_longer-wide-to-long" class="section level3" number="1.7.14">
<h3>
<span class="header-section-number">1.7.14</span> pivot_longer(): Wide to Long<a class="anchor" aria-label="anchor" href="#pivot_longer-wide-to-long"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert to long format</span></span>
<span><span class="va">proteomics_long</span> <span class="op">&lt;-</span> <span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"2"</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"Sample"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"Intensity"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">proteomics_long</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 9</span></span>
<span><span class="co">#&gt;    accession gene   peptide_count unique_peptides</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;           &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 F1LMU0    F1LMU0           338             138</span></span>
<span><span class="co">#&gt;  2 F1LMU0    F1LMU0           338             138</span></span>
<span><span class="co">#&gt;  3 F1LMU0    F1LMU0           338             138</span></span>
<span><span class="co">#&gt;  4 F1LMU0    F1LMU0           338             138</span></span>
<span><span class="co">#&gt;  5 F1LMU0    F1LMU0           338             138</span></span>
<span><span class="co">#&gt;  6 F1LMU0    F1LMU0           338             138</span></span>
<span><span class="co">#&gt;  7 F1LMU0    F1LMU0           338             138</span></span>
<span><span class="co">#&gt;  8 F1LMU0    F1LMU0           338             138</span></span>
<span><span class="co">#&gt;  9 F1LMU0    F1LMU0           338             138</span></span>
<span><span class="co">#&gt; 10 F1LMU0    F1LMU0           338             138</span></span>
<span><span class="co">#&gt; # ℹ 5 more variables: confidence_score &lt;dbl&gt;, mass &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   description &lt;chr&gt;, Sample &lt;chr&gt;, Intensity &lt;dbl&gt;</span></span></code></pre></div>
<hr>
</div>
<div id="why-long-format" class="section level3" number="1.7.15">
<h3>
<span class="header-section-number">1.7.15</span> Why Long Format?<a class="anchor" aria-label="anchor" href="#why-long-format"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Advantages for analysis:</strong></p>
<ul>
<li>Easier grouping and summarizing</li>
<li>Better for ggplot2 visualizations</li>
<li>Facilitates statistical modeling</li>
<li>Standard format for many tools</li>
</ul>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate statistics by sample</span></span>
<span><span class="va">proteomics_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Sample</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    mean_intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Intensity</span><span class="op">)</span>,</span>
<span>    median_intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Intensity</span><span class="op">)</span>,</span>
<span>    n_proteins <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span><span class="co">#&gt;   Sample          mean_intensity median_intensity n_proteins</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt;      &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 2126001_029_f5        3059149.           91354.        824</span></span>
<span><span class="co">#&gt; 2 2126001_068_f3        3782834.           76089.        824</span></span>
<span><span class="co">#&gt; 3 2126001_134_f11       3189430.           84892.        824</span></span>
<span><span class="co">#&gt; 4 2126001_180_f2        2687642.          129483.        824</span></span>
<span><span class="co">#&gt; 5 2126001_198_f12       2881252.           93655.        824</span></span>
<span><span class="co">#&gt; 6 2126001_270_f7        2088286.           95672.        824</span></span></code></pre></div>
<hr>
</div>
<div id="pivot_wider-long-to-wide" class="section level3" number="1.7.16">
<h3>
<span class="header-section-number">1.7.16</span> pivot_wider(): Long to Wide<a class="anchor" aria-label="anchor" href="#pivot_wider-long-to-wide"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert back to wide format</span></span>
<span><span class="va">proteomics_wide</span> <span class="op">&lt;-</span> <span class="va">proteomics_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">Sample</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">Intensity</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">proteomics_wide</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 10</span></span>
<span><span class="co">#&gt;   accession  gene       peptide_count unique_peptides</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;              &lt;dbl&gt;           &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 F1LMU0     F1LMU0               338             138</span></span>
<span><span class="co">#&gt; 2 G3V8V3     G3V8V3               146             113</span></span>
<span><span class="co">#&gt; 3 A0A0G2JSP8 A0A0G2JSP8           117             109</span></span>
<span><span class="co">#&gt; 4 Q64578     AT2A1                126              89</span></span>
<span><span class="co">#&gt; 5 D4AEH9     D4AEH9                87              83</span></span>
<span><span class="co">#&gt; 6 P15429     ENOB                 110              83</span></span>
<span><span class="co">#&gt; # ℹ 6 more variables: confidence_score &lt;dbl&gt;, mass &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   description &lt;chr&gt;, `2126001_029_f5` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `2126001_359_f9` &lt;dbl&gt;, `2126001_401_f1` &lt;dbl&gt;</span></span></code></pre></div>
<hr>
</div>
<div id="working-with-strings-with-stringr" class="section level3" number="1.7.17">
<h3>
<span class="header-section-number">1.7.17</span> Working with Strings with <code>stringr</code><a class="anchor" aria-label="anchor" href="#working-with-strings-with-stringr"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract gene names</span></span>
<span><span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Convert to uppercase</span></span>
<span>    gene_upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span>,</span>
<span>    <span class="co"># Detect pattern</span></span>
<span>    is_kinase <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">description</span>, <span class="st">"kinase"</span><span class="op">)</span>,</span>
<span>    <span class="co"># Extract words</span></span>
<span>    first_word <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/word.html">word</a></span><span class="op">(</span><span class="va">description</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">gene</span>, <span class="va">description</span>, <span class="va">is_kinase</span>, <span class="va">first_word</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 4</span></span>
<span><span class="co">#&gt;   gene       description                is_kinase first_word</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;                      &lt;lgl&gt;     &lt;chr&gt;     </span></span>
<span><span class="co">#&gt; 1 F1LMU0     Myosin heavy chain 4       FALSE     Myosin    </span></span>
<span><span class="co">#&gt; 2 G3V8V3     Alpha-1,4 glucan phosphor… FALSE     Alpha-1,4 </span></span>
<span><span class="co">#&gt; 3 A0A0G2JSP8 Creatine kinase            TRUE      Creatine</span></span></code></pre></div>
<hr>
</div>
<div id="handling-missing-values" class="section level3" number="1.7.18">
<h3>
<span class="header-section-number">1.7.18</span> Handling Missing Values<a class="anchor" aria-label="anchor" href="#handling-missing-values"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create data with missing values</span></span>
<span><span class="va">data_with_na</span> <span class="op">&lt;-</span> <span class="va">proteomics_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    `2126001_029_f5` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">`2126001_029_f5`</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">`2126001_029_f5`</span>, <span class="fl">0.2</span><span class="op">)</span>, </span>
<span>                     <span class="cn">NA</span>, <span class="va">`2126001_029_f5`</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Check missing values</span></span>
<span><span class="va">data_with_na</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    n_total <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    n_missing_s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`2126001_029_f5`</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    percent_missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`2126001_029_f5`</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span><span class="co">#&gt;   n_total n_missing_s1 percent_missing</span></span>
<span><span class="co">#&gt;     &lt;int&gt;        &lt;int&gt;           &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     824          165            20.0</span></span>
<span></span>
<span><span class="co"># Remove rows with NA</span></span>
<span><span class="va">data_with_na</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`2126001_029_f5`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 659</span></span>
<span></span>
<span><span class="co"># Replace NA with value</span></span>
<span><span class="va">data_with_na</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>`2126001_029_f5` <span class="op">=</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na</a></span><span class="op">(</span><span class="va">`2126001_029_f5`</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 19</span></span>
<span><span class="co">#&gt;   accession  gene       peptide_count unique_peptides</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;              &lt;dbl&gt;           &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 F1LMU0     F1LMU0               338             138</span></span>
<span><span class="co">#&gt; 2 G3V8V3     G3V8V3               146             113</span></span>
<span><span class="co">#&gt; 3 A0A0G2JSP8 A0A0G2JSP8           117             109</span></span>
<span><span class="co">#&gt; # ℹ 15 more variables: confidence_score &lt;dbl&gt;, mass &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   description &lt;chr&gt;, `2126001_029_f5` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `2126001_359_f9` &lt;dbl&gt;, `2126001_401_f1` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `2126001_180_f2` &lt;dbl&gt;, `2126001_416_f6` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `2126001_422_f10` &lt;dbl&gt;, `2126001_068_f3` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `2126001_134_f11` &lt;dbl&gt;, `2126001_270_f7` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `2126001_198_f12` &lt;dbl&gt;, `2126001_312_f8` &lt;dbl&gt;, …</span></span></code></pre></div>
<hr>
</div>
<div id="hands-on-exercise" class="section level3" number="1.7.19">
<h3>
<span class="header-section-number">1.7.19</span> Hands-On Exercise<a class="anchor" aria-label="anchor" href="#hands-on-exercise"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Task:</strong> Transform and analyze your proteomics data</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Load your data</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"your_data.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Filter and calculate</span></span>
<span><span class="va">high_quality</span> <span class="op">&lt;-</span> <span class="va">my_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">confidence_score</span> <span class="op">&gt;</span> <span class="fl">10000</span>, <span class="va">peptide_count</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>mean_intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"sample"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Convert to long format</span></span>
<span><span class="va">long_data</span> <span class="op">&lt;-</span> <span class="va">my_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"sample"</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"Sample"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 4. Calculate CV per protein</span></span>
<span><span class="va">cv_data</span> <span class="op">&lt;-</span> <span class="va">long_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">accession</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_int <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Intensity</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            sd_int <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Intensity</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            cv <span class="op">=</span> <span class="op">(</span><span class="va">sd_int</span> <span class="op">/</span> <span class="va">mean_int</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="day-1-summary" class="section level2" number="1.8">
<h2>
<span class="header-section-number">1.8</span> Day 1 Summary<a class="anchor" aria-label="anchor" href="#day-1-summary"><i class="fas fa-link"></i></a>
</h2>
<p>Today you learned:</p>
<ul class="task-list">
<li><label><input type="checkbox" checked>How to set up R and RStudio</label></li>
<li><label><input type="checkbox" checked>Basic R operators and syntax</label></li>
<li><label><input type="checkbox" checked>Data structures: vectors, data frames, lists, factors</label></li>
<li><label><input type="checkbox" checked>Indexing and subsetting data</label></li>
<li><label><input type="checkbox" checked>Control flow: if/else, loops</label></li>
<li><label><input type="checkbox" checked>Writing custom functions</label></li>
<li><label><input type="checkbox" checked>Importing and exploring data</label></li>
<li><label><input type="checkbox" checked>Itroduction to <code>tidyverse</code> and data wrangling</label></li>
</ul>
<div id="homework" class="section level3" number="1.8.1">
<h3>
<span class="header-section-number">1.8.1</span> Homework<a class="anchor" aria-label="anchor" href="#homework"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Install all required packages for Day 2</li>
<li>Practice writing functions for data manipulation</li>
<li>Explore the built-in datasets in R (use <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code> to see available datasets)</li>
</ol>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install packages for Day 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, <span class="st">"dplyr"</span>, <span class="st">"tidyr"</span>, <span class="st">"pheatmap"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/">"BiocManager"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html">install</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"limma"</span>, <span class="st">"vsn"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="additional-resources" class="section level2" number="1.9">
<h2>
<span class="header-section-number">1.9</span> Additional Resources<a class="anchor" aria-label="anchor" href="#additional-resources"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>
<a href="https://r4ds.had.co.nz/">R for Data Science</a> by Hadley Wickham</li>
<li><a href="https://posit.co/resources/cheatsheets/">RStudio Cheat Sheets</a></li>
<li>
<a href="https://stackoverflow.com/questions/tagged/r">Stack Overflow</a> for questions</li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="index.html">Welcome </a></div>
<div class="next"><a href="day2.html"><span class="header-section-number">2</span> Introduction to Proteomic Data &amp; Quality Control</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#day1"><span class="header-section-number">1</span> Introduction to R and RStudio</a></li>
<li><a class="nav-link" href="#learning-objectives"><span class="header-section-number">1.1</span> Learning Objectives</a></li>
<li>
<a class="nav-link" href="#day1-mod1"><span class="header-section-number">1.2</span> Module 1: Setting Up and Getting Started with R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#introduction"><span class="header-section-number">1.2.1</span> Introduction</a></li>
<li><a class="nav-link" href="#installing-r-and-rstudio"><span class="header-section-number">1.2.2</span> Installing R and RStudio</a></li>
<li><a class="nav-link" href="#rstudio-interface-tour"><span class="header-section-number">1.2.3</span> RStudio Interface Tour</a></li>
<li><a class="nav-link" href="#scripts-vs-console"><span class="header-section-number">1.2.4</span> Scripts vs Console</a></li>
<li><a class="nav-link" href="#install-required-r-packages"><span class="header-section-number">1.2.5</span> Install Required R Packages</a></li>
<li><a class="nav-link" href="#basic-operators"><span class="header-section-number">1.2.6</span> Basic Operators</a></li>
<li><a class="nav-link" href="#variables-assignment"><span class="header-section-number">1.2.7</span> Variables &amp; Assignment</a></li>
<li><a class="nav-link" href="#data-types"><span class="header-section-number">1.2.8</span> Data Types</a></li>
<li><a class="nav-link" href="#creating-your-first-script"><span class="header-section-number">1.2.9</span> Creating Your First Script</a></li>
<li><a class="nav-link" href="#exercise-1.1-first-steps"><span class="header-section-number">1.2.10</span> Exercise 1.1: First Steps</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#day1-mod2"><span class="header-section-number">1.3</span> Module 2: Data Types and Structures</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#vectors"><span class="header-section-number">1.3.1</span> Vectors</a></li>
<li><a class="nav-link" href="#indexing-and-subsetting"><span class="header-section-number">1.3.2</span> Indexing and Subsetting</a></li>
<li><a class="nav-link" href="#data-frames"><span class="header-section-number">1.3.3</span> Data Frames</a></li>
<li><a class="nav-link" href="#lists"><span class="header-section-number">1.3.4</span> Lists</a></li>
<li><a class="nav-link" href="#factors"><span class="header-section-number">1.3.5</span> Factors</a></li>
<li><a class="nav-link" href="#type-coercion"><span class="header-section-number">1.3.6</span> Type Coercion</a></li>
<li><a class="nav-link" href="#exercise-1.2-data-structures"><span class="header-section-number">1.3.7</span> Exercise 1.2: Data Structures</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#day1-mod3"><span class="header-section-number">1.4</span> Module 3: Control Flow and Functions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#conditional-statements"><span class="header-section-number">1.4.1</span> Conditional Statements</a></li>
<li><a class="nav-link" href="#loops"><span class="header-section-number">1.4.2</span> Loops</a></li>
<li><a class="nav-link" href="#functions"><span class="header-section-number">1.4.3</span> Functions</a></li>
<li><a class="nav-link" href="#apply-family-functions"><span class="header-section-number">1.4.4</span> Apply Family Functions</a></li>
<li><a class="nav-link" href="#exercise-1.3-functions-and-loops"><span class="header-section-number">1.4.5</span> Exercise 1.3: Functions and Loops</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#day1-mod5"><span class="header-section-number">1.5</span> Module 4: Data Visualization with ggplot2</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#loading-required-packages"><span class="header-section-number">1.5.1</span> Loading Required Packages</a></li>
<li><a class="nav-link" href="#understanding-the-ggplot2-structure"><span class="header-section-number">1.5.2</span> Understanding the ggplot2 structure</a></li>
<li><a class="nav-link" href="#example-dataset"><span class="header-section-number">1.5.3</span> Example Dataset</a></li>
<li><a class="nav-link" href="#histogram-distribution-of-protein-abundance"><span class="header-section-number">1.5.4</span> Histogram: Distribution of Protein Abundance</a></li>
<li><a class="nav-link" href="#boxplot-comparing-conditions"><span class="header-section-number">1.5.5</span> Boxplot: Comparing Conditions</a></li>
<li><a class="nav-link" href="#scatter-plot-individual-points-with-mean-values"><span class="header-section-number">1.5.6</span> Scatter Plot: Individual Points with Mean Values</a></li>
<li><a class="nav-link" href="#density-plot-distribution-by-condition"><span class="header-section-number">1.5.7</span> Density Plot: Distribution by Condition</a></li>
<li><a class="nav-link" href="#summary"><span class="header-section-number">1.5.8</span> Summary</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#module-5-importing-and-exploring-data"><span class="header-section-number">1.6</span> Module 5: Importing and Exploring Data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#reading-common-file-types"><span class="header-section-number">1.6.1</span> Reading common file types</a></li>
<li><a class="nav-link" href="#saving-data"><span class="header-section-number">1.6.2</span> Saving data</a></li>
<li><a class="nav-link" href="#basic-data-exploration"><span class="header-section-number">1.6.3</span> Basic Data Exploration</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#module-6-data-wrangling-with-tidyverse"><span class="header-section-number">1.7</span> Module 6: Data Wrangling with tidyverse</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#introduction-to-tidyverse"><span class="header-section-number">1.7.1</span> Introduction to tidyverse</a></li>
<li><a class="nav-link" href="#the-pipe-operator"><span class="header-section-number">1.7.2</span> The Pipe Operator %&gt;%</a></li>
<li><a class="nav-link" href="#your-actual-proteomics-data-structure"><span class="header-section-number">1.7.3</span> Your Actual Proteomics Data Structure</a></li>
<li><a class="nav-link" href="#dplyr-grammar-of-data-manipulation"><span class="header-section-number">1.7.4</span> dplyr: Grammar of Data Manipulation</a></li>
<li><a class="nav-link" href="#select-choose-columns"><span class="header-section-number">1.7.5</span> select(): Choose Columns</a></li>
<li><a class="nav-link" href="#filter-choose-rows"><span class="header-section-number">1.7.6</span> filter(): Choose Rows</a></li>
<li><a class="nav-link" href="#mutate-create-new-columns"><span class="header-section-number">1.7.7</span> mutate(): Create New Columns</a></li>
<li><a class="nav-link" href="#arrange-sort-data"><span class="header-section-number">1.7.8</span> arrange(): Sort Data</a></li>
<li><a class="nav-link" href="#summarize-calculate-statistics"><span class="header-section-number">1.7.9</span> summarize(): Calculate Statistics</a></li>
<li><a class="nav-link" href="#group_by-grouped-operations"><span class="header-section-number">1.7.10</span> group_by(): Grouped Operations</a></li>
<li><a class="nav-link" href="#combining-operations-pipeline"><span class="header-section-number">1.7.11</span> Combining Operations: Pipeline</a></li>
<li><a class="nav-link" href="#tidyr-reshaping-data"><span class="header-section-number">1.7.12</span> tidyr: Reshaping Data</a></li>
<li><a class="nav-link" href="#wide-vs-long-format"><span class="header-section-number">1.7.13</span> Wide vs Long Format</a></li>
<li><a class="nav-link" href="#pivot_longer-wide-to-long"><span class="header-section-number">1.7.14</span> pivot_longer(): Wide to Long</a></li>
<li><a class="nav-link" href="#why-long-format"><span class="header-section-number">1.7.15</span> Why Long Format?</a></li>
<li><a class="nav-link" href="#pivot_wider-long-to-wide"><span class="header-section-number">1.7.16</span> pivot_wider(): Long to Wide</a></li>
<li><a class="nav-link" href="#working-with-strings-with-stringr"><span class="header-section-number">1.7.17</span> Working with Strings with stringr</a></li>
<li><a class="nav-link" href="#handling-missing-values"><span class="header-section-number">1.7.18</span> Handling Missing Values</a></li>
<li><a class="nav-link" href="#hands-on-exercise"><span class="header-section-number">1.7.19</span> Hands-On Exercise</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#day-1-summary"><span class="header-section-number">1.8</span> Day 1 Summary</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#homework"><span class="header-section-number">1.8.1</span> Homework</a></li></ul>
</li>
<li><a class="nav-link" href="#additional-resources"><span class="header-section-number">1.9</span> Additional Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/lodiag-holocron/r4proteomics/blob/master/day1_intro_to_r.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/lodiag-holocron/r4proteomics/edit/master/day1_intro_to_r.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>r4proteomics</strong>: 5-Day Training Course" was written by Miguel CASANOVA, PhD &amp; Dany MUKESHA. It was last built on 2025-11-21.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
